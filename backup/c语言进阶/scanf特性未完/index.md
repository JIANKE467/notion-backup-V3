---
{
  "id": "4a372325-7363-4466-ad8b-c899a645de94",
  "url": "https://www.notion.so/scanf-4a37232573634466ad8bc899a645de94",
  "created_time": "2025-05-02T05:10:00.000Z",
  "last_edited_time": "2025-06-05T16:28:00.000Z"
}
---

#  scanf特性（未完）

# scanf特性（未完）
## 缓冲输入
scanf 使用输入缓冲区来存储输入的数据。当调用 scanf 时，它从缓冲区中读取数据，而不是直接从输入设备读取。
‍
## 阻塞调用
scanf 是一个阻塞函数，这意味着如果输入缓冲区为空，程序将暂停执行，等待用户输入数据。
‍
‍
‍
## 错误处理
当使用`scanf`函数进行输入时，如果输入的字符不符合格式控制符指定的类型，`scanf`的行为将取决于具体的格式控制符和输入情况。以下是一些常见的情况：
1. **整数输入（错误不输入）** ：
  - 如果输入的不是有效的整数（例如，输入了字母或特殊字符），`scanf`将无法解析该输入，并且输入将被留在输入缓冲区中，等待下一次输入调用读取。
1. **浮点数输入（错误不输入）** ：
  - 如果输入的不是有效的浮点数（例如，输入了字母或特殊字符），`scanf`将无法解析该输入，并且输入将被留在输入缓冲区中。
1. **字符输入（对不对都输入）** ：
  - 对于`%c`格式控制符，`scanf`将读取下一个字符，无论它是什么。这意味着即使是不符合预期的字符也会被读取。
1. **字符串输入（遇到空格，空白字符，制表符，换行符停止）** ：
  - 对于`%s`格式控制符，`scanf`将读取直到遇到空白字符（空格、制表符或换行符）为止的字符串。如果输入包含空白字符，`scanf`将停止读取，并将剩余的输入留在缓冲区中。
1. **不匹配的输入**：
  - 如果输入的字符不符合格式控制符指定的类型，`scanf`将返回一个值，表示成功读取的输入项的数量。如果返回值小于预期的输入项数量，表示有输入项未成功读取。
1. **缓冲区中的剩余输入**：
  - 如果`scanf`无法解析输入或只部分解析了输入，未解析的输入将留在输入缓冲区中，可能会影响后续的输入调用。
‍
# scanf读取到空格停止/scanf读取跳过部分字符
scanf() 函数读到空格就停止读取的现象，主要与格式说明符的使用方式有关（例如 %s、%d 等）

 一、基础数据类型控制符
1. %d  %u  %x  %o   
行为：（整数）自动跳过前导空白字符（空格、换行符、制表符），直到遇到非数字字符时停止输入

2. %f  %lf  %e
行为：（浮点）跳过前导空白字符，遇到非数字或指数符号外的字符终止。     
注意：%lf`在scanf中是必需的（与printf不同），否则可能因类型不匹配导致错误

3. %c     
行为：（字符），不跳过任何空白字符，包括空格和换行符。
若需跳过前导空白，需在%c前加空格
 
4. %s  
行为：（字符串）遇到空白字符即终止，并在末尾自动添加空字符`\0`。需确保目标数组足够大以避免溢出

二、高级格式控制符
5. %[]
（扫描集合）
行为：按自定义字符集合匹配输入。
%[a-z]表示仅接收小写字母
%[^\n]表示读取到换行符前所有字符（含空格）   

6. %*
（抑制赋值）
行为：跳过匹配的输入字段，常用于忽略不需要的部分。    

7. 宽度限定符
（如`%5d`）
行为：限制读取的字符数量，防止溢出或截断无效数据。     

8. 长度修饰符
（如`%ld` / `%hd`）
行为：指定数据类型长度。`%ld`读取`long int`，`%hd`读取`short int`。     - **注意**：长度修饰符必须与变量类型严格匹配。
---
 三、特殊场景与陷阱**- **混合输入问题**：    当数值型（如`%d`）与字符型（如`%c`）控制符混合使用时，**残留的换行符可能导致意外读取**。需用`while (getchar() != '\n');`清空缓冲区。
- **非格式字符匹配**：    格式字符串中的非格式字符（如逗号）需与输入严格匹配，否则导致解析失败。    ```c  scanf("Value:%d", &num);  // 输入必须为"Value:123"，否则匹配失败
