---
{
  "id": "29f5a2dd-8276-80ad-b5e4-da9aa629a13d",
  "url": "https://www.notion.so/8-29f5a2dd827680adb5e4da9aa629a13d",
  "created_time": "2025-11-02T08:26:00.000Z",
  "last_edited_time": "2025-12-19T08:09:00.000Z"
}
---

#  8.约束

# 语法
列级：
```sql
字段名 字段类型 [约束]
```
表级：
```sql
约束 (对应字段)
```
**约束是作用于表中字段上的，可以在创建表/修改表的时候添加约束**
# 常见约束
| 约束 | 描述 | 关键字 |
| --- | --- | --- |
| 非空约束 | 限制该字段的数据不能为null | not null |
| 唯一约束 | 限制该字段的所有数据都是不重复的 | unique |
| 主键约束 | 主键是一行数据的唯一标识,要求非空且唯一 | primary key |
| 默认约束 | 保存数据时，如果未指定该字段的值，则采用default后的值作为默认值 | default |
| 检查约束（8.0.16版本后） | 检查字段的值满足check后的条件 | check |
| 外键约束 | 用来让两张表的数据之间建立连接,保证数据的一致性和完整性 | foreign key |
其他约束关键字：
auto_increment：自增
# 外键约束
  ## 添加外键
  ### 语法
  写法1 : 建表时添加外键
  ```sql
create table 表名 (
  字段名 数据类型,
  ...
  [constraint][外键名] foreign key (外键字段名) references 主表(字段名)
);
  ```
  写法2 : 建表后添加外键
  ```sql
alter table 表名 add constraint 外键名称 foreign key(外键字段名) references 主表(主表字段名);
  ```
  **注意⚠️：在添加外键之前要先创建两个表中相应的字段，以上的语句只起到关联两个字段的作用，不会创建字段**
  > PS：关于为什么在建表时 “constraint 外键名称” 是可选的？
标准的写法就是第二种写法，但在建表时可以省略  “constraint 外键名称”  ，这样的外键叫 “匿名外键” ，与c语言的结构体不同，这里的匿名外键实际上会被系统自动起一个名字，因此也是可以删除的（需要先查询外键名字）
  ## 删除外键
  ### 语法
  ```sql
alter table 表名 drop foreign key 外键名;
  ```
  ## 外键约束
  与约束不同，外键约束定义的是当父表删除/更新时，子表如何处理
  | 行为 | 说明 |
  | --- | --- |
  | no action
（默认） | 当在父表中删除更新对应记录时,首先检查该记录是否有对应外键如果有则不允许删除/更新。
（与restrict相同） |
  | restrict | 当在父表中删除/更新对应记录时,首先检查该记录是否有对应外键，如果有则不允许删除/更新。（与no action相同） |
  | cascade | （级联）当在父表中删除/更新对应记录时,首先检查该记录是否有对应外键，如果有，则也删除/更新外键在子表中的记录。 |
  | set null | 当在父表中删除对应记录时,首先检查该记录是否有对应外键，如果有则设置子表中该外键值为null（这就要求该外键允许取nul) |
  | set default | 父表有变更时，子表将外键列设置成一个默认的值(MySQL的引擎lnnodb不支持) |
  ### 语法
  在创建外键的语句后面加上 “on updat 关键字 on delete 关键字” 来定义在修改和删除时的处理策略
  （下面以写法二为例）
  ```sql
alter table 表名 add constraint 外键名 foreign key (外键字段) references 主表名 (主表字段) on update 行为 on delete 行为;
  ```
  > 级联删除会删除相应的整条记录，而非相应记录的某个字段
# 表级约束/列级约束
  ## 表级约束
    ### 增
    方法1：建表时添加
    ```sql
CREATE TABLE 表名 (  
  字段1,  
  字段2,
  ....
  约束1 (相应字段1),  
  约束2 (相应字段2)
);
    ```
    方法二：建表后添加
    ```sql
ALTER TABLE 表名
ADD 约束 (相应字段);
    ```
    ### 删
    ```sql
ALTER TABLE 表名
DROP 约束 约束名;
    ```
    PS：约束名是系统自动起的一般叫 `fk_相应字段名`
    PS：删除主键约束（primary key）不用约束名因为主键是唯一的
    ### 改
    没有改的语法，只能先删除再添加
  ## 列级约束
    **列级约束与字段捆绑，想要增删改列级约束要使用字段的增删改方法**
